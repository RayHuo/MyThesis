\begin{algorithm}\label{DSLUPX}
	\SetKwData{Dis}{dis}
	\SetKwFunction{CalculateHammingDistance}{CalculateHammingDistance}
	\SetKw{downto}{downto}\SetKw{return}{return}\SetKw{Break}{break}
	\SetKwInOut{Input}{输入}\SetKwInOut{Output}{输出}
	\caption{计算关键半环集的算法$dsl_U(P,X)$}
	\Input{一个逻辑程序$P$和一个原子集$X$}
	\Output{关键半环集$dsl$}
	
	$dsl~:=~\emptyset$；      \\
	\For {非空子集$S_1 \subseteq head(in_U(P))$和$S_2 \subseteq body^+(out_U(P))$} {
		$G^S_P~:=~G_P$关于$S_1 \cup S_2 \cup (Atoms(P) \backslash (head(in_U(P)) \cup body^+(out_U(P))))$的子图；\\
		$L~:=~G^S_P$的一个强连通分量，并满足$S_1 \cup S_2 \subseteq L$；\\
		\If {$L$不存在} {
			break;
		}
		\If {$L \cap U \subseteq X$且$R^-(L \cap U, P, X) \subseteq in_U(P)$} {
			把$L \cap U$加入到$dsl$中；	\\
		}
		\Else {
			$S~:=~head(R^-(L \cap U, P, X) \backslash in_U(P)) \cup ((L \cap U) \backslash X)$；	\\
			$G^S_P~:=~G_P$关于$L \backslash S$的子图；	\\
			$goto~5$；
		}
	}
	
%	\While {$U~is~changed$} {
%		$rules~:=~\{r \in P | head(r) \cap a \neq \emptyset \}$ \\
%		\For {$rule \in rules$} {
%			$U~:=~U \cup Atoms(rule)$
%		}
%		$a~:=~U$中的下一个原子；\\
%	}
	
	\return $dsl$
\end{algorithm}
